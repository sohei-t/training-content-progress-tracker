# クリティカルパス分析 - 革新的アプローチ

## 1. クリティカルパス概要

```
T-001 → T-101 → T-102 → T-103 → T-105 → T-106 → T-107
  ↓                                                ↓
T-201 → T-202 → T-203 ─────────────────────────→ T-207
                                                   ↓
                                               T-301 → T-302 → T-402
```

### 主要クリティカルパス
| 順序 | タスクID | タスク名 | 所要時間 | 累計時間 |
|------|---------|---------|---------|---------|
| 1 | T-001 | プロジェクト初期化 | 0.5h | 0.5h |
| 2 | T-101 | データベース設計・実装 | 1.5h | 2.0h |
| 3 | T-102 | WBSパーサー実装 | 2.0h | 4.0h |
| 4 | T-103 | ファイルスキャナー実装 | 2.0h | 6.0h |
| 5 | T-105 | REST API実装 | 2.0h | 8.0h |
| 6 | T-106 | WebSocket実装 | 1.5h | 9.5h |
| 7 | T-107 | メイン統合 | 1.0h | 10.5h |
| 8 | T-301 | 結合テスト | 1.5h | 12.0h |
| 9 | T-302 | リアルタイムテスト | 1.0h | 13.0h |
| 10 | T-402 | E2Eテスト | 2.0h | 15.0h |

**クリティカルパス所要時間: 15時間（約2日）**

---

## 2. 最適化戦略

### 2.1 並列化による短縮

#### バックエンド並列化（T-103 完了後）
```
         ┌─ T-104 (ファイルウォッチャー) ─┐
T-103 ───┤                               ├─→ T-107
         └─ T-105 (REST API) ─→ T-106 ───┘
```
- **効果**: 1.5時間短縮

#### フロントエンド並列化（T-201 完了後）
```
         ┌─ T-205 (WebSocket) ──────────┐
T-201 ───┼─ T-206 (API通信) ────────────┼─→ T-207
         └─ T-202 → T-203 → T-204 ──────┘
```
- **効果**: 2時間短縮

### 2.2 最適化後のタイムライン

| 日 | 時間帯 | タスク | 備考 |
|----|-------|-------|------|
| Day 1 | 0-2h | T-001, T-101 | 初期化・DB |
| Day 1 | 2-6h | T-102, T-201 | パーサー・フロントエンド基盤（並列） |
| Day 1 | 6-8h | T-103, T-202 | スキャナー・ダッシュボード（並列） |
| Day 2 | 0-4h | T-104/T-105/T-106, T-203/T-204 | バックエンド・フロントエンド並列 |
| Day 2 | 4-6h | T-107, T-207 | 統合 |
| Day 2 | 6-8h | T-301, T-302 | 結合テスト |
| Day 3 | 0-4h | T-401/T-402/T-403 | テスト実行 |
| Day 3 | 4-6h | T-501/T-502, T-601 | ドキュメント・デリバリー |

**最適化後: 22時間（約2.5日）→ 実働3日で余裕を持って完了**

---

## 3. リスク分析と対策

### 3.1 高リスクタスク

| タスク | リスク | 影響度 | 対策 |
|-------|-------|-------|------|
| T-102 | WBS形式の複雑さ | 高 | 事前にサンプル解析済み、両形式対応設計 |
| T-106 | WebSocket安定性 | 中 | 再接続ロジック実装、フォールバック設計 |
| T-203 | 仮想スクロール | 中 | vue-virtual-scroller利用、シンプル実装も用意 |

### 3.2 リスク軽減策

#### WBSパーサー（T-102）
```python
# リスク軽減: 形式自動検出 + フォールバック
def parse_wbs(path: str) -> WBSData:
    try:
        data = load_json(path)
        format_type = detect_format(data)
        if format_type == 'object':
            return parse_object_format(data)
        elif format_type == 'array':
            return parse_array_format(data)
    except Exception:
        # フォールバック: ファイル直接スキャンで進捗計算
        return scan_content_folder(path)
```

#### WebSocket（T-106）
```javascript
// リスク軽減: 自動再接続 + ポーリングフォールバック
class ReconnectingWebSocket {
    maxRetries = 5;
    fallbackToPolling = true;
}
```

---

## 4. 効率化のポイント

### 4.1 技術選定による効率化

| 技術 | 効率化ポイント | 時間削減 |
|-----|--------------|---------|
| FastAPI | 自動ドキュメント生成 | -1時間 |
| Vue.js CDN | ビルド不要 | -0.5時間 |
| Tailwind CDN | CSS設計不要 | -1時間 |
| aiosqlite | 非同期で高速 | 実行時性能向上 |

### 4.2 コード再利用

```yaml
再利用可能コンポーネント:
  - WebSocketマネージャー（backend/frontend共通設計）
  - 進捗計算ロジック（バックエンドで一元化）
  - UIコンポーネント（Tailwindで統一）
```

### 4.3 テスト効率化

```yaml
テスト戦略:
  優先度1: E2Eテスト（ユーザーフロー）
  優先度2: 統合テスト（API + DB）
  優先度3: ユニットテスト（パーサーのみ重点）

  省略可能:
    - UIコンポーネント単体テスト
    - スタイルテスト
```

---

## 5. 成功指標

### 5.1 マイルストーン達成基準

| マイルストーン | 達成基準 | 確認方法 |
|--------------|---------|---------|
| M1 バックエンド | APIが応答する | curl テスト |
| M2 フロントエンド | 画面が表示される | ブラウザ確認 |
| M3 統合 | リアルタイム更新動作 | ファイル追加→即時反映 |
| M4 リリース | E2Eテスト全合格 | Playwright実行 |

### 5.2 パフォーマンス指標

| 指標 | 目標値 | 許容値 |
|-----|-------|-------|
| 初回スキャン | < 3秒 | < 5秒 |
| 差分スキャン | < 100ms | < 500ms |
| API応答 | < 50ms | < 200ms |
| WebSocket遅延 | < 50ms | < 100ms |
| FCP | < 1.0秒 | < 2.0秒 |

---

## 6. まとめ

### クリティカルパスの特徴（革新的アプローチ）

1. **イベント駆動設計**
   - ファイル変更 → WebSocket → 即時更新
   - ポーリング不要で効率的

2. **非同期処理の活用**
   - asyncio + aiofiles + aiosqlite
   - I/O待ち時間を最小化

3. **並列化の最大活用**
   - バックエンド3タスク並列
   - フロントエンド3タスク並列
   - テスト3タスク並列

4. **リスク対策の事前準備**
   - WBSフォールバック設計
   - WebSocket再接続ロジック
   - シンプル版UIも用意

**結論: 3日間で高品質なリアルタイムダッシュボードを完成可能**
